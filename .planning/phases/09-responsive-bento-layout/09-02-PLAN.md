---
phase: 09-responsive-bento-layout
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - src/components/BentoGrid.tsx
  - src/components/BentoCanvas.jsx
autonomous: true

must_haves:
  truths:
    - "Bento grid fits within 100dvh with no vertical scrolling"
    - "Grid uses preset configuration for columns and rows"
    - "Grid responds to breakpoint changes without janky rearrangement"
  artifacts:
    - path: "src/components/BentoGrid.tsx"
      provides: "Main responsive grid container"
      exports: ["BentoGrid"]
      min_lines: 50
    - path: "src/components/BentoCanvas.jsx"
      provides: "Updated canvas using new BentoGrid"
  key_links:
    - from: "src/components/BentoGrid.tsx"
      to: "src/store/useLayoutStore.ts"
      via: "useLayoutStore hook"
      pattern: "useLayoutStore"
    - from: "src/components/BentoGrid.tsx"
      to: "src/hooks/useBreakpoint.ts"
      via: "useBreakpoint hook"
      pattern: "useBreakpoint"
---

<objective>
Create responsive BentoGrid component that fits within 100dvh and uses layout presets.

Purpose: Main grid container that enforces viewport height constraint and adapts to breakpoints.
Output: BentoGrid component integrated into existing BentoCanvas.
</objective>

<execution_context>
@/Users/sannagranqvist/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sannagranqvist/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/09-responsive-bento-layout/09-RESEARCH.md
@.planning/phases/09-responsive-bento-layout/09-01-SUMMARY.md
@src/components/BentoCanvas.jsx
@src/config/layoutPresets.ts
@src/store/useLayoutStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BentoGrid component with viewport fitting</name>
  <files>src/components/BentoGrid.tsx</files>
  <action>
Create the main BentoGrid component:

```typescript
import React, { ReactNode } from 'react';
import { useLayoutStore } from '../store/useLayoutStore';
import { useBreakpoint } from '../hooks/useBreakpoint';
import { LAYOUT_PRESETS } from '../config/layoutPresets';
import { cn } from '../utils/cn'; // or use twMerge if cn doesn't exist

interface BentoGridProps {
  children: ReactNode;
  className?: string;
}

export const BentoGrid = ({ children, className }: BentoGridProps) => {
  const breakpoint = useBreakpoint();
  const preset = useLayoutStore((s) => s.preset);
  const density = useLayoutStore((s) => s.density);

  const config = LAYOUT_PRESETS[preset];
  const columns = config.columns[breakpoint];
  const rows = config.rows[breakpoint];
  const gap = config.gap[density];
  const rowHeight = config.rowHeight[density];

  return (
    <div
      className={cn(
        // Viewport height with dvh and safe area handling
        'h-[100dvh] max-h-[100dvh]',
        // Mobile safe area padding
        'pb-[env(safe-area-inset-bottom)]',
        // Grid setup
        'grid',
        // Padding
        density === 'cozy' ? 'p-4' : 'p-2',
        // Overflow hidden to prevent scrolling
        'overflow-hidden',
        // Optional custom class
        className
      )}
      style={{
        gridTemplateColumns: `repeat(${columns}, 1fr)`,
        gridTemplateRows: `repeat(${rows}, ${rowHeight}px)`,
        gap: `${gap}px`,
        // Fallback for browsers without dvh
        height: '100vh',
      }}
    >
      {children}
    </div>
  );
};

export default BentoGrid;
```

Key features:
1. Uses 100dvh with 100vh fallback (CSS cascades)
2. Applies safe-area-inset-bottom for mobile
3. max-h-[100dvh] prevents overflow
4. overflow-hidden ensures no scrolling
5. Dynamic grid based on preset and breakpoint
6. Density affects gap and row height
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit src/components/BentoGrid.tsx`
  </verify>
  <done>
BentoGrid component created with 100dvh viewport fitting and responsive grid.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate BentoGrid into BentoCanvas</name>
  <files>src/components/BentoCanvas.jsx</files>
  <action>
Update BentoCanvas.jsx to use the new BentoGrid component:

1. Import BentoGrid at top of file:
```javascript
import { BentoGrid } from './BentoGrid';
```

2. Replace the existing grid div structure. Current code:
```jsx
<div className="min-h-full flex items-center justify-center p-12">
  <div className="w-full max-w-[1600px]">
    <AnimatePresence mode="wait">
      <motion.div
        key={darkModePreview ? "dark" : "light"}
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
        transition={{ duration: 0.2 }}
        className="grid grid-cols-4 auto-rows-[280px] gap-4"
      >
        {tiles.map((tile, index) => (
          <BrandTile key={tile.id} tile={tile} index={index} />
        ))}
      </motion.div>
    </AnimatePresence>
  </div>
</div>
```

Replace with:
```jsx
<AnimatePresence mode="wait">
  <motion.div
    key={darkModePreview ? "dark" : "light"}
    initial={{ opacity: 0 }}
    animate={{ opacity: 1 }}
    exit={{ opacity: 0 }}
    transition={{ duration: 0.2 }}
    className="h-full"
  >
    <BentoGrid>
      {tiles.map((tile, index) => (
        <BrandTile key={tile.id} tile={tile} index={index} />
      ))}
    </BentoGrid>
  </motion.div>
</AnimatePresence>
```

3. Update the outer container (the flex-1 div) to remove the padding that would interfere:
- Remove `overflow-auto` (grid handles overflow now)
- Keep background color transition

The outer div should become:
```jsx
<div
  className="flex-1 transition-colors duration-300"
  style={{ backgroundColor: darkModePreview ? "#050505" : "#FAFAFA" }}
  onClick={() => setFocusedTile(null)}
>
```
  </action>
  <verify>
Run dev server and verify:
1. Grid is visible and fills viewport height
2. No vertical scrollbar appears
3. Tiles render in grid
`npm run dev` and check browser at localhost
  </verify>
  <done>
BentoCanvas updated to use BentoGrid with viewport-fitted layout.
  </done>
</task>

</tasks>

<verification>
1. BentoGrid component renders without errors
2. Grid fills exactly 100dvh (no scrollbar)
3. Tiles appear in grid layout
4. Grid responds to preset changes (verify in React DevTools)
</verification>

<success_criteria>
- BentoGrid.tsx exports BentoGrid component
- BentoCanvas.jsx imports and uses BentoGrid
- Grid fits within viewport height with no vertical scrolling
- Grid uses preset-defined columns and rows
</success_criteria>

<output>
After completion, create `.planning/phases/09-responsive-bento-layout/09-02-SUMMARY.md`
</output>
