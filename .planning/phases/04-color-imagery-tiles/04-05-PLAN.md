---
phase: 04-color-imagery-tiles
plan: 05
type: execute
wave: 4
depends_on: ["04-02", "04-04"]
files_modified:
  - src/App.tsx
autonomous: false

must_haves:
  truths:
    - "Color tile displays swatches, contrast badge, and presets"
    - "Imagery tile displays image with treatment or gradient fallback"
    - "Color picker drag updates canvas under 50ms"
    - "Palette preset hover previews across canvas"
    - "Treatment preset hover previews on image"
    - "Duotone uses current brand colors"
  artifacts: []
  key_links: []
---

<objective>
Integration checkpoint: Verify color and imagery tiles work together with live updates, hover previews, and proper canvas integration.

Purpose: Ensure all Phase 4 components function correctly as an integrated system before marking phase complete.
Output: Verified working color and imagery tiles ready for Phase 5 (System View).
</objective>

<execution_context>
@/Users/sannagranqvist/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sannagranqvist/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-color-imagery-tiles/04-02-SUMMARY.md
@.planning/phases/04-color-imagery-tiles/04-03-SUMMARY.md
@.planning/phases/04-color-imagery-tiles/04-04-SUMMARY.md

# Components to integrate
@src/components/tiles/ColorTile.tsx
@src/components/tiles/ImageryTile.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate tiles into App.tsx canvas</name>
  <files>
    src/App.tsx
  </files>
  <action>
Update `src/App.tsx` to include ColorTile and ImageryTile in the canvas grid:

```typescript
// Add imports
import { ColorTile } from '@/components/tiles/ColorTile';
import { ImageryTile } from '@/components/tiles/ImageryTile';

// In the grid, add tiles at their positions:
// Color tile: column 1, row 2 (1x1)
// Imagery tile: column 3, rows 1-2 (1x2 spanning)

// The existing grid should have placeholder divs - replace them with:
<ColorTile />
<ImageryTile className="row-span-2" />
```

Ensure:
1. ColorTile is positioned in the correct grid cell (col 1, row 2)
2. ImageryTile spans 2 rows (col 3, rows 1-2) using `row-span-2` class
3. Both tiles integrate with the existing tile interaction pattern (hover/click)
  </action>
  <verify>
    `npm run dev` starts without errors
    ColorTile visible in grid at correct position
    ImageryTile spans 2 rows at correct position
  </verify>
  <done>
    Tiles integrated into App.tsx canvas grid.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete color and imagery tiles with:
    - Color swatches by role (primary, accent, background, text)
    - WCAG contrast badge always visible
    - HSL color picker with hue ring and HEX input
    - Palette presets with hover preview
    - Color role reassignment
    - Edge-to-edge imagery display
    - Gradient fallback
    - Drag-and-drop image upload
    - 6 treatment presets with hover preview
    - Duotone using brand colors
  </what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Open browser to http://localhost:5173

    **Color Tile Tests:**
    3. Locate color tile in grid (should show 4 stacked swatches)
    4. Check contrast badge is visible (shows ratio like "21:1 AAA")
    5. Click any swatch -> HSL picker opens with hue ring
    6. Drag hue ring -> canvas colors update smoothly (no lag)
    7. Type hex in input -> color updates
    8. Hover palette preset -> entire palette previews across canvas
    9. Click preset -> palette commits
    10. Change role dropdown -> picker now edits different color

    **Imagery Tile Tests:**
    11. Locate imagery tile (spans 2 rows on right side)
    12. If no image: gradient fallback using brand colors visible
    13. Hover tile -> upload overlay appears
    14. Click or drag image file -> image uploads and displays
    15. Image fills edge-to-edge with cover fit
    16. Click tile to enter edit mode -> treatment presets appear
    17. Hover treatment thumbnail -> treatment previews on main image
    18. Click "Duotone" -> image uses current primary/background colors
    19. Change primary color -> duotone image updates to new color

    **Performance Tests:**
    20. Drag color picker continuously for 3 seconds
        - Canvas updates should be smooth, no dropped frames
        - DevTools Performance tab should show ~60fps
    21. Rapidly hover different palette presets
        - Previews should be instant, no flicker
  </how-to-verify>
  <resume-signal>
    Type "approved" if all tests pass, or describe any issues found.
  </resume-signal>
</task>

</tasks>

<verification>
Human verification of:
1. Color tile displays correctly with all controls
2. Imagery tile displays correctly with treatments
3. Performance meets sub-50ms update requirement
4. Hover previews work for both presets and treatments
5. Duotone updates when colors change
6. All requirements COLR-01 through COLR-11 and IMGR-01 through IMGR-08 satisfied
</verification>

<success_criteria>
- Color tile shows 4 swatches stacked by role (COLR-01)
- Contrast badge always visible (COLR-02)
- HSL picker with hue ring and saturation/lightness (COLR-03, COLR-04)
- HEX input works (COLR-05)
- Drag updates under 50ms (COLR-06, COLR-11)
- 5 palette presets available (COLR-07)
- Preset hover previews (COLR-08)
- Role reassignment works (COLR-09)
- Low contrast shows warning (COLR-10)
- Image fills edge-to-edge (IMGR-01)
- Gradient fallback when no image (IMGR-02)
- Drag-and-drop upload works (IMGR-03)
- 6 treatment presets available (IMGR-04)
- Duotone uses brand colors (IMGR-05)
- Treatment hover previews (IMGR-07)
- Treatment thumbnails show filter applied (IMGR-08)
</success_criteria>

<output>
After completion, create `.planning/phases/04-color-imagery-tiles/04-05-SUMMARY.md`
</output>
